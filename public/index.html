<!doctype html>
<html ng-app="shardalyzer-ui">
	<head>
		<title>Shardalyzer</title>
		<script src="/bower_components/jquery/dist/jquery.min.js"></script>

		<script src="/bower_components/angular/angular.min.js"></script>
		<script src="/bower_components/Chart.js/Chart.min.js"></script>

		<link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="/bower_components/angular-bootstrap/ui-bootstrap-csp.css">
		<script src="/bower_components/angular-bootstrap/ui-bootstrap.min.js"></script>
		<script src="/bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>

		<link rel="stylesheet" href="/bower_components/seiyria-bootstrap-slider/css/bootstrap-slider.css">
		<script src="/bower_components/seiyria-bootstrap-slider/js/bootstrap-slider.js"></script>
		<script src="/bower_components/angular-bootstrap-slider/slider.js"></script>

		<link rel="stylesheet" href="/bower_components/angular-chart.js/dist/angular-chart.css">
		<script src="/bower_components/angular-chart.js/dist/angular-chart.min.js"></script>

		<link rel="stylesheet" href="/bower_components/json-formatter/dist/json-formatter.min.css">
		<script src="/bower_components/json-formatter/dist/json-formatter.min.js"></script>

		<link rel="stylesheet" href="/bower_components/jasny-bootstrap/dist/css/jasny-bootstrap.min.css" media="screen">
		<script src="/bower_components/jasny-bootstrap/dist/js/jasny-bootstrap.min.js"></script>
		<script src="/bower_components/jasny-bootstrap/js/offcanvas.js"></script>

		<link rel="stylesheet" href="/bower_components/angular-growl-v2/build/angular-growl.min.css">
		<script src="/bower_components/angular-growl-v2/build/angular-growl.min.js"></script>

		<script src="/bower_components/angular-animate/angular-animate.min.js"></script>

		<link rel="stylesheet" href="stylesheets/chart-tooltip.css">
		<link rel="stylesheet" href="stylesheets/navmenu-push.css">
		<link rel="stylesheet" href="stylesheets/style.css">
		<script src="js/chart-tooltip.js"></script>

		<script src="js/shardalyzer.js"></script>
		<script src="js/shardalyzer-ctrl.js"></script>
	</head>

	<body>
	    <div growl limit-messages="5"></div>

		<div id="navcontainer" style="height:100%;">
			<div class="navbar navbar-default navbar-fixed-top" style="width:100%;">
				<button type="button" class="navbar-toggle" data-toggle="offcanvas" data-target="#navmenu" data-canvas="#navcontainer" data-placement="left">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<span class="navbar-brand" href="#"></span>
			</div>

			<nav id="navmenu" class="navmenu navmenu-default navmenu-fixed-left offcanvas" role="navigation">
				<span class="navmenu-brand">Connect to Server</span>
					<ul class="nav navmenu-nav">
					<li class="active"><a href="#"><small>Specify connection parameters</small></a></li>
					<li><a href="#">Host&nbsp;&nbsp;&nbsp;&nbsp;
							<input type="text" style="color: #333; font-weight:normal" ng-model="mongo.host" ng-model-options="{updateOn : 'change blur'}" />
						</a>
					</li>
					<li><a href="#">Port&nbsp;&nbsp;&nbsp;&nbsp;
							<input type="text" style="color: #333; font-weight:normal" ng-model="mongo.port" ng-model-options="{updateOn : 'change blur'}" />
						</a>
					</li>
					<li><a href="#">NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<select style="color: #333; font-weight:normal" ng-controller="nsList" ng-model="mongo.selectedNS" ng-options="ns as ns for ns in mongo.nsList">
								<option value="">[namespace]</option>
							</select>
						</a>
					</li>
				</ul>
			</nav>

			<div id="header"></div>
			<div id="footer"></div>

			<div id="content">
				<div class="row-fluid row-centered" style="padding:60px 0 0 0; height:40vh; overflow:auto" ng-controller="updateCharts">
					<div ng-repeat="(shard, chunks) in chartmeta.data" class="col-md-4 col-centered">
						<canvas id="doughnut_shard" class="chart chart-doughnut"
							options="chartmeta.options"
							data="chunks"
							labels="chartmeta.labels[shard]"
							colours="chartmeta.colors[shard]"></canvas>
					    <p align="center"><b>{{shard}} : {{chunks.length}}</b></p>
					</div>
				</div>

			    <div id="chartjs-tooltip-shard" class="chartjs-tooltip" style="visibility:hidden; z-index:100"></div>

				<div class="row" style="width:75%; margin:0 auto; display:table; border-collapse:collapse;">
					<div class="btn-group" style="display:table-cell; min-width:350px" role="group" ng-controller="playControl">
						<button type="button" class="btn btn-primary" ng-click="playctrl.start();" value="|<">
							<span class="glyphicon glyphicon-fast-backward" aria-hidden="true"></span>
						</button>
						<button type="button" class="btn btn-info" ng-click="playctrl.fastforward();" value="<<">
							<span class="glyphicon glyphicon-backward" aria-hidden="true"></span>
						</button>
						<button type="button" class="btn btn-danger" ng-click="playctrl.forwardError();" value="! <">
							<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
						</button>
						<button type="button" class="btn btn-default" ng-click="playctrl.forward();" value="<">
							<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
						</button>
						<button type="button" class="btn btn-default" ng-click="playctrl.back();" value=">">
							<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
						</button>
						<button type="button" class="btn btn-danger" ng-click="playctrl.backError();" value="> !">
							<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
						</button>
						<button type="button" class="btn btn-info" ng-click="playctrl.rewind();" value=">>">
							<span class="glyphicon glyphicon-forward" aria-hidden="true"></span>
						</button>
						<button type="button" class="btn btn-primary" ng-click="playctrl.end();" value=">|">
							<span class="glyphicon glyphicon-fast-forward" aria-hidden="true"></span>
						</button>
					</div>

					<div style="display:table-cell; width:100%" ng-controller="sliderControl">
						<slider ng-model="mongo.ui.slider"
							min="slidermeta.min"
							max="slidermeta.max"
							value="mongo.ui.slider"
							ticks="mongo.ui.errors"
							ticksLabels="slidermeta.ticklabels"
							ticks_snap_bounds="slidermeta.snap"
							formatter="slidermeta.formatter">
						</slider>
					</div>
				</div>

				<div class="row" style="width:75%; margin:0 auto;" ng-style="{ 'visibility' : (mongo.shardalyzer.changes[mongo.ui.slider].details.errmsg != undefined ? 'visible' : 'hidden') }">
					<alert type="danger">{{mongo.shardalyzer.changes[mongo.ui.slider].details.errmsg}}&nbsp;</alert>
				</div>

				<div style="width:75%; margin: auto; position:fixed; bottom:70px; left:0; right:0;">
					<tabset>
						<tab heading="Changelog">
							<div style="width:100%; height:19em; max-height:19em; margin:0 auto; display:table; border-collapse:collapse;">
								<div id="changelist" style="display:table-cell; width:100%;" ng-controller="changelogControl">
									<select class="form-control" size=15 style="width:100%; overflow-x:scroll;"
										ng-options="index as change | json for (index, change) in mongo.ui.changelog"
										ng-model="mongo.ui.selectedchange">
									</select>
								</div>

								<div style="min-width:385px; max-width:385px; height:100%; overflow-y:scroll; background:white" ng-show="mongo.ui.changelog[mongo.ui.selectedchange] !== undefined">
									<json-formatter json="mongo.ui.changelog[mongo.ui.selectedchange]" open="3"></json-formatter>
								</div>
							</div>
						</tab>
						<tab heading="Query">
							<div ng-controller="queryCtrl" style="width:100%; margin:0 auto; display:table; border-collapse:collapse;">
								<input type="text" style="width:100%; display:table-cell;" ng-model="query.query" ng-model-options="{updateOn : 'change'}" />

								<button type="button" class="btn btn-primary" ng-click="query.submit()" value="?">
									<span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span>
								</button>

								<textarea style="width:100%; display:table-cell; height:20em;" ng-model="query.result" />
							</div>
						</tab>
					</tabset>
				</div>
			</div>
		</div>

	</body>

</html>